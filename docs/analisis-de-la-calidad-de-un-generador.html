<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>3.2 Análisis de la calidad de un generador | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="3.2 Análisis de la calidad de un generador | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Análisis de la calidad de un generador | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)">


<meta name="date" content="2020-02-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="cap3-gen-cong.html">
<link rel="next" href="ejercicios-de-fin-de-practica.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion.html"><a href="introduccion.html#ventajas-e-inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="generacion-de-numeros-pseudoaleatorios.html"><a href="generacion-de-numeros-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="numeros-aleatorios-puros.html"><a href="numeros-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="numeros-aleatorios-puros.html"><a href="numeros-aleatorios-puros.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="numeros-aleatorios-puros.html"><a href="numeros-aleatorios-puros.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="numeros-pseudoaleatorios.html"><a href="numeros-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="opciones.html"><a href="opciones.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="cap3-gen-cong.html"><a href="cap3-gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="cap3-gen-cong.html"><a href="cap3-gen-cong.html#conlinsim"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="cap3-gen-cong.html"><a href="cap3-gen-cong.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="cap3-gen-cong.html"><a href="cap3-gen-cong.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="analisis-de-la-calidad-de-un-generador.html"><a href="analisis-de-la-calidad-de-un-generador.html"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="analisis-de-la-calidad-de-un-generador.html"><a href="analisis-de-la-calidad-de-un-generador.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="analisis-de-la-calidad-de-un-generador.html"><a href="analisis-de-la-calidad-de-un-generador.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ejercicios-de-fin-de-practica.html"><a href="ejercicios-de-fin-de-practica.html"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-resultados-de-simulacion.html"><a href="analisis-de-resultados-de-simulacion.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a><ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a><ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#deteccion-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimacion-de-la-precision.html"><a href="estimacion-de-la-precision.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-limite.html"><a href="teorema-central-del-limite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinacion-del-numero-de-generaciones.html"><a href="determinacion-del-numero-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a><ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="5.1" data-path="metodo-de-inversion.html"><a href="metodo-de-inversion.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a><ul>
<li class="chapter" data-level="5.1.1" data-path="metodo-de-inversion.html"><a href="metodo-de-inversion.html#ejemplo"><i class="fa fa-check"></i><b>5.1.1</b> Ejemplo</a></li>
<li class="chapter" data-level="5.1.2" data-path="metodo-de-inversion.html"><a href="metodo-de-inversion.html#algunas-distribuciones-que-pueden-simularse-por-el-metodo-de-inversion"><i class="fa fa-check"></i><b>5.1.2</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.3" data-path="metodo-de-inversion.html"><a href="metodo-de-inversion.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.3</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.4" data-path="metodo-de-inversion.html"><a href="metodo-de-inversion.html#inversion-aproximada"><i class="fa fa-check"></i><b>5.1.4</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="metodo-de-aceptacion-rechazo.html"><a href="metodo-de-aceptacion-rechazo.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a><ul>
<li class="chapter" data-level="5.2.1" data-path="metodo-de-aceptacion-rechazo.html"><a href="metodo-de-aceptacion-rechazo.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="metodo-de-aceptacion-rechazo.html"><a href="metodo-de-aceptacion-rechazo.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="metodo-de-aceptacion-rechazo.html"><a href="metodo-de-aceptacion-rechazo.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="metodo-de-aceptacion-rechazo.html"><a href="metodo-de-aceptacion-rechazo.html#ejemplo-1"><i class="fa fa-check"></i><b>5.2.4</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-metodo-de-ar.html"><a href="modificaciones-del-metodo-de-ar.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de AR</a><ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-metodo-de-ar.html"><a href="modificaciones-del-metodo-de-ar.html#muestreo-por-rechazo-adaptativo-ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-metodo-de-ar.html"><a href="modificaciones-del-metodo-de-ar.html#metodo-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="metodo-de-composicion.html"><a href="metodo-de-composicion.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición</a><ul>
<li class="chapter" data-level="5.4.1" data-path="metodo-de-composicion.html"><a href="metodo-de-composicion.html#ejemplo-2"><i class="fa fa-check"></i><b>5.4.1</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="metodos-especificos-para-generacion-de-distribuciones-notables.html"><a href="metodos-especificos-para-generacion-de-distribuciones-notables.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="6.1" data-path="metodo-de-la-transformacion-cuantil.html"><a href="metodo-de-la-transformacion-cuantil.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a><ul>
<li class="chapter" data-level="6.1.1" data-path="metodo-de-la-transformacion-cuantil.html"><a href="metodo-de-la-transformacion-cuantil.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="metodo-de-la-tabla-guia.html"><a href="metodo-de-la-tabla-guia.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulacion-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulacion-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="calculo-directo-de-la-funcion-cuantil.html"><a href="calculo-directo-de-la-funcion-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-metodos.html"><a href="otros-metodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="metodos-especificos-para-generacion-de-distribuciones-notables-1.html"><a href="metodos-especificos-para-generacion-de-distribuciones-notables-1.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>7</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="7.1" data-path="introduccion-1.html"><a href="introduccion-1.html"><i class="fa fa-check"></i><b>7.1</b> Introducción</a></li>
<li class="chapter" data-level="7.2" data-path="el-metodo-de-aceptacionrechazo.html"><a href="el-metodo-de-aceptacionrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="factorizacion-de-la-matriz-de-covarianzas.html"><a href="factorizacion-de-la-matriz-de-covarianzas.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a><ul>
<li class="chapter" data-level="7.3.1" data-path="factorizacion-de-la-matriz-de-covarianzas.html"><a href="factorizacion-de-la-matriz-de-covarianzas.html#simulacion-de-la-normal-multivariante"><i class="fa fa-check"></i><b>7.3.1</b> Simulación de la normal multivariante</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="metodo-de-las-distribuciones-condicionadas.html"><a href="metodo-de-las-distribuciones-condicionadas.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulacion-condicional-e-incondicional.html"><a href="simulacion-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulacion-condicional-e-incondicional.html"><a href="simulacion-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulacion-condicional-e-incondicional.html"><a href="simulacion-condicional-e-incondicional.html#simulacion-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulacion-basada-en-copulas.html"><a href="simulacion-basada-en-copulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a><ul>
<li class="chapter" data-level="7.6.1" data-path="simulacion-basada-en-copulas.html"><a href="simulacion-basada-en-copulas.html#copulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulacion-basada-en-copulas.html"><a href="simulacion-basada-en-copulas.html#simulacion"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="otros-metodos-para-variables-continuas.html"><a href="otros-metodos-para-variables-continuas.html"><i class="fa fa-check"></i><b>7.7</b> Otros métodos para variables continuas</a></li>
<li class="chapter" data-level="7.8" data-path="simulacion-de-distribuciones-multidimensionales-discretas.html"><a href="simulacion-de-distribuciones-multidimensionales-discretas.html"><i class="fa fa-check"></i><b>7.8</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulacion-de-distribuciones-multidimensionales-discretas.html"><a href="simulacion-de-distribuciones-multidimensionales-discretas.html#metodos-de-codificacion-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.8.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulacion-de-distribuciones-multidimensionales-discretas.html"><a href="simulacion-de-distribuciones-multidimensionales-discretas.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.8.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulacion-de-distribuciones-multidimensionales-discretas.html"><a href="simulacion-de-distribuciones-multidimensionales-discretas.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>7.8.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="ejercicios-propuestos.html"><a href="ejercicios-propuestos.html"><i class="fa fa-check"></i><b>7.9</b> Ejercicios propuestos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="8.1" data-path="aplicaciones-de-la-simulacion.html"><a href="aplicaciones-de-la-simulacion.html"><i class="fa fa-check"></i><b>8.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="8.2" data-path="distribucion-en-el-muestreo.html"><a href="distribucion-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.4" data-path="contrastes-de-hipotesis.html"><a href="contrastes-de-hipotesis.html"><i class="fa fa-check"></i><b>8.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.5" data-path="comparacion-de-estimadores.html"><a href="comparacion-de-estimadores.html"><i class="fa fa-check"></i><b>8.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.6" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html"><i class="fa fa-check"></i><b>8.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="8.6.1" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#idea"><i class="fa fa-check"></i><b>8.6.1</b> Idea:</a></li>
<li class="chapter" data-level="8.6.2" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.6.3" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#ejemplo-3"><i class="fa fa-check"></i><b>8.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="8.6.4" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.6.5" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#graficos"><i class="fa fa-check"></i><b>8.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="8.6.6" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Integracion y Optimizacion Montecarlo</a><ul>
<li class="chapter" data-level="9.1" data-path="integracion-monte-carlo-clasica.html"><a href="integracion-monte-carlo-clasica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a><ul>
<li class="chapter" data-level="9.1.1" data-path="integracion-monte-carlo-clasica.html"><a href="integracion-monte-carlo-clasica.html#ejercicio-1"><i class="fa fa-check"></i><b>9.1.1</b> Ejercicio 1</a></li>
<li class="chapter" data-level="9.1.2" data-path="integracion-monte-carlo-clasica.html"><a href="integracion-monte-carlo-clasica.html#caso-general"><i class="fa fa-check"></i><b>9.1.2</b> Caso general</a></li>
<li class="chapter" data-level="9.1.3" data-path="integracion-monte-carlo-clasica.html"><a href="integracion-monte-carlo-clasica.html#ejercicio-2"><i class="fa fa-check"></i><b>9.1.3</b> Ejercicio 2</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html#ejercicio-3"><i class="fa fa-check"></i><b>9.2.1</b> Ejercicio 3</a></li>
<li class="chapter" data-level="9.2.2" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html#ejercicio-4"><i class="fa fa-check"></i><b>9.2.2</b> Ejercicio 4</a></li>
<li class="chapter" data-level="9.2.3" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.3</b> Remuestreo (del muestreo) por importancia</a></li>
<li class="chapter" data-level="9.2.4" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html#ejercicio-5"><i class="fa fa-check"></i><b>9.2.4</b> Ejercicio 5</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimizacion-monte-carlo.html"><a href="optimizacion-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a><ul>
<li class="chapter" data-level="9.3.1" data-path="optimizacion-monte-carlo.html"><a href="optimizacion-monte-carlo.html#ejercicio-6"><i class="fa fa-check"></i><b>9.3.1</b> Ejercicio 6</a></li>
<li class="chapter" data-level="9.3.2" data-path="optimizacion-monte-carlo.html"><a href="optimizacion-monte-carlo.html#algoritmos-de-optimizacion-monte-carlo"><i class="fa fa-check"></i><b>9.3.2</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a><ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
<li class="chapter" data-level="9.4.2" data-path="temple-simulado.html"><a href="temple-simulado.html#ejercicio-7"><i class="fa fa-check"></i><b>9.4.2</b> Ejercicio 7</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-geneticos.html"><a href="algoritmos-geneticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a><ul>
<li class="chapter" data-level="9.5.1" data-path="algoritmos-geneticos.html"><a href="algoritmos-geneticos.html#ejercicio-8"><i class="fa fa-check"></i><b>9.5.1</b> Ejercicio 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="reduccion-de-la-varianza.html"><a href="reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="variables-antiteticas.html"><a href="variables-antiteticas.html"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="variables-antiteticas.html"><a href="variables-antiteticas.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="variables-antiteticas.html"><a href="variables-antiteticas.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="estratificacion.html"><a href="estratificacion.html"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="numeros-aleatorios-comunes.html"><a href="numeros-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="ejercicios-fin-de-practica.html"><a href="ejercicios-fin-de-practica.html"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="bibliografia-basica.html"><a href="bibliografia-basica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografia-complementaria.html"><a href="bibliografia-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="introduccion-2.html"><a href="introduccion-2.html"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica-unidimensional.html"><a href="integracion-numerica-unidimensional.html"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica-unidimensional.html"><a href="integracion-numerica-unidimensional.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica-unidimensional.html"><a href="integracion-numerica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica-unidimensional.html"><a href="integracion-numerica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica-unidimensional.html"><a href="integracion-numerica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica-bidimensional.html"><a href="integracion-numerica-bidimensional.html"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica-bidimensional.html"><a href="integracion-numerica-bidimensional.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica-bidimensional.html"><a href="integracion-numerica-bidimensional.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica-bidimensional.html"><a href="integracion-numerica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>B.3.3</b> Comandos de <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analisis-de-la-calidad-de-un-generador" class="section level2">
<h2><span class="header-section-number">3.2</span> Análisis de la calidad de un generador</h2>
<p>Para verificar si un generador tiene las propiedades estadísticas deseadas hay disponibles una gran cantidad de test de hipótesis (baterías de contrastes) y métodos gráficos:</p>
<ul>
<li><p>Contrastes genéricos de bondad de ajuste y aleatoriedad.</p></li>
<li><p>Contrastes específicos para generadores aleatorios.</p></li>
</ul>
<p>Se trata principalmente de contrastar si las muestras generadas son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (análisis univariante). Aunque los métodos más avanzados tratan normalmente de contrastar si las <span class="math inline">\(k\)</span>-uplas:</p>
<p><span class="math display">\[(U_{t+1},U_{t+2},...,U_{t+k-1}); \ t=(i-1)k, \ i=1,...,m\]</span></p>
<p>son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)^{k}\)</span> (uniformes independientes en el hipercubo; análisis multivariante).</p>
<p><strong>Nos centraremos en los métodos genéricos</strong>. Pueden usarse en:</p>
<ul>
<li><p>Evaluación de generadores aleatorios</p></li>
<li><p>Evaluación de generadores de variables aleatorias</p></li>
<li><p>Modelado de entradas de modelos de simulación</p></li>
</ul>
<p>Uno de los contrastes más conocidos es el test ji-cuadrado de bondad de ajuste (<code>chisq.test</code> para el caso discreto). Aunque si la variable de interés es continua, habría que discretizarla (con la correspondiente perdida de información). Por ejemplo, se podría emplear la siguiente función (que imita a las incluídas en <code>R</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-------------------------------------------------------------------------------</span>
<span class="co"># chisq.test.cont(x, distribution, nclasses, output, nestpar,...)</span>
<span class="co">#-------------------------------------------------------------------------------</span>
<span class="co"># Realiza el test ji-cuadrado de bondad de ajuste para una distribución continua</span>
<span class="co"># discretizando en intervalos equiprobables.</span>
<span class="co"># Parámetros:</span>
<span class="co">#   distribution = &quot;norm&quot;,&quot;unif&quot;,etc</span>
<span class="co">#   nclasses = floor(length(x)/5)</span>
<span class="co">#   output = TRUE</span>
<span class="co">#   nestpar = 0= nº de parámetros estimados</span>
<span class="co">#   ... = parámetros distribución</span>
<span class="co"># Ejemplo:</span>
<span class="co">#   chisq.test.cont(x, distribution=&quot;norm&quot;, nestpar=2, mean=mean(x), sd=sqrt((nx-1)/nx)*sd(x))</span>
<span class="co">#-------------------------------------------------------------------------------</span>
chisq.test.cont &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">distribution =</span> <span class="st">&quot;norm&quot;</span>, <span class="dt">nclasses =</span> <span class="kw">floor</span>(<span class="kw">length</span>(x)<span class="op">/</span><span class="dv">5</span>), 
    <span class="dt">output =</span> <span class="ot">TRUE</span>, <span class="dt">nestpar =</span> <span class="dv">0</span>, ...) {
    <span class="co"># Funciones distribución</span>
    q.distrib &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;q&quot;</span>, distribution, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)))
    d.distrib &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;d&quot;</span>, distribution, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)))
    <span class="co"># Puntos de corte</span>
    q &lt;-<span class="st"> </span><span class="kw">q.distrib</span>((<span class="dv">1</span><span class="op">:</span>(nclasses <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))<span class="op">/</span>nclasses, ...)
    tol &lt;-<span class="st"> </span><span class="kw">sqrt</span>(.Machine<span class="op">$</span>double.eps)
    xbreaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(x) <span class="op">-</span><span class="st"> </span>tol, q, <span class="kw">max</span>(x) <span class="op">+</span><span class="st"> </span>tol)
    <span class="co"># Gráficos y frecuencias</span>
    <span class="cf">if</span> (output) {
        xhist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> xbreaks, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;grey50&quot;</span>)
        <span class="kw">curve</span>(<span class="kw">d.distrib</span>(x, ...), <span class="dt">add =</span> <span class="ot">TRUE</span>)
    } <span class="cf">else</span> {
        xhist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> xbreaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
    }
    <span class="co"># Cálculo estadístico y p-valor</span>
    O &lt;-<span class="st"> </span>xhist<span class="op">$</span>counts  <span class="co"># Equivalente a table(cut(x, xbreaks)) pero más eficiente</span>
    E &lt;-<span class="st"> </span><span class="kw">length</span>(x)<span class="op">/</span>nclasses
    DNAME &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
    METHOD &lt;-<span class="st"> &quot;Pearson&#39;s Chi-squared test&quot;</span>
    STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((O <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
    <span class="kw">names</span>(STATISTIC) &lt;-<span class="st"> &quot;X-squared&quot;</span>
    PARAMETER &lt;-<span class="st"> </span>nclasses <span class="op">-</span><span class="st"> </span>nestpar <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
    <span class="kw">names</span>(PARAMETER) &lt;-<span class="st"> &quot;df&quot;</span>
    PVAL &lt;-<span class="st"> </span><span class="kw">pchisq</span>(STATISTIC, PARAMETER, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
    <span class="co"># Preparar resultados</span>
    classes &lt;-<span class="st"> </span><span class="kw">format</span>(xbreaks)
    classes &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;(&quot;</span>, classes[<span class="op">-</span>(nclasses <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)], <span class="st">&quot;,&quot;</span>, classes[<span class="op">-</span><span class="dv">1</span>], <span class="st">&quot;]&quot;</span>, 
        <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
    RESULTS &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">classes =</span> classes, <span class="dt">observed =</span> O, <span class="dt">expected =</span> E, <span class="dt">residuals =</span> (O <span class="op">-</span><span class="st"> </span>
<span class="st">        </span>E)<span class="op">/</span><span class="kw">sqrt</span>(E))
    <span class="cf">if</span> (output) {
        <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Pearson&#39;s Chi-squared test table</span><span class="ch">\n</span><span class="st">&quot;</span>)
        <span class="kw">print</span>(<span class="kw">as.data.frame</span>(RESULTS))
    }
    <span class="cf">if</span> (<span class="kw">any</span>(E <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>)) 
        <span class="kw">warning</span>(<span class="st">&quot;Chi-squared approximation may be incorrect&quot;</span>)
    <span class="kw">structure</span>(<span class="kw">c</span>(<span class="kw">list</span>(<span class="dt">statistic =</span> STATISTIC, <span class="dt">parameter =</span> PARAMETER, <span class="dt">p.value =</span> PVAL, 
        <span class="dt">method =</span> METHOD, <span class="dt">data.name =</span> DNAME), RESULTS), <span class="dt">class =</span> <span class="st">&quot;htest&quot;</span>)
}</code></pre></div>
<p>Por ejemplo, continuando con el generador congruencial anterior, obtendríamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test.cont</span>(u, <span class="dt">distribution =</span> <span class="st">&quot;unif&quot;</span>, 
                <span class="dt">nclasses =</span> <span class="dv">10</span>, <span class="dt">nestpar =</span> <span class="dv">0</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre><code>## 
## Pearson&#39;s Chi-squared test table
##                          classes observed expected  residuals
## 1  (-1.490116e-08, 1.000000e-01]       51       50  0.1414214
## 2  ( 1.000000e-01, 2.000000e-01]       49       50 -0.1414214
## 3  ( 2.000000e-01, 3.000000e-01]       49       50 -0.1414214
## 4  ( 3.000000e-01, 4.000000e-01]       50       50  0.0000000
## 5  ( 4.000000e-01, 5.000000e-01]       51       50  0.1414214
## 6  ( 5.000000e-01, 6.000000e-01]       51       50  0.1414214
## 7  ( 6.000000e-01, 7.000000e-01]       49       50 -0.1414214
## 8  ( 7.000000e-01, 8.000000e-01]       50       50  0.0000000
## 9  ( 8.000000e-01, 9.000000e-01]       50       50  0.0000000
## 10 ( 9.000000e-01, 9.980469e-01]       50       50  0.0000000</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  u
## X-squared = 0.12, df = 9, p-value = 1</code></pre>
<p><strong>Importante</strong>:</p>
<p>Empleando los métodos genéricos del modo habitual, desconfiamos del generador si la muestra/secuencia no se ajusta a la distribución teórica (<em>p</em>-valor <span class="math inline">\(\leq \alpha\)</span>). En este caso además, <strong>también se sospecha si se ajusta demasiado bien</strong> a la distribución teórica (<em>p</em>-valor <span class="math inline">\(\geq1-\alpha\)</span>).</p>
<p>Otro contraste de bondad de ajuste muy conocido es el test de Kolmogorov-Smirnov, implementado en <code>ks.test</code>.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-11" class="exercise"><strong>Ejercicio 2.6  </strong></span>
</div>

<p>Continuando con el generador congruencial anterior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">initRANDC</span>(<span class="dv">321</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">512</span>)       <span class="co"># Fijar semilla para reproductibilidad</span>
nsim &lt;-<span class="st"> </span><span class="dv">500</span>
<span class="kw">system.time</span>(u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(nsim))  <span class="co"># Generar</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Realizar el contraste de Kolmogorov-Smirnov para estudiar el ajuste a una <span class="math inline">\(\mathcal{U}(0,1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(u)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">curve</span>(<span class="kw">punif</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(u, <span class="st">&quot;punif&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  u
## D = 0.0033281, p-value = 1
## alternative hypothesis: two-sided</code></pre></li>
<li><p>Obtener el gráfico secuencial y el de dispersión retardado, ¿se observa algún problema?</p>
<p>Gráfico secuencial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">as.ts</span>(u))</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Gráfico de dispersión retardado:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(u[<span class="op">-</span>nsim],u[<span class="op">-</span><span class="dv">1</span>])</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Estudiar las correlaciones del vector <span class="math inline">\((u_{i},u_{i+k})\)</span>, con <span class="math inline">\(k=1,...,10\)</span>. Contrastar si son nulas.</p>
<p>Correlaciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(u)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Test de Ljung-Box:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Box.test</span>(u, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="dt">type =</span> <span class="st">&quot;Ljung&quot;</span>)</code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  u
## X-squared = 22.533, df = 10, p-value = 0.01261</code></pre></li>
</ol>
<div id="repeticion-de-contrastes" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Repetición de contrastes</h3>
<p>Los contrastes se plantean habitualmente desde el punto de vista de la inferencia estadística en la práctica: se realiza una prueba sobre la única muestra disponible. Si se realiza una única prueba, en las condiciones de <span class="math inline">\(H_{0}\)</span> hay una probabilidad <span class="math inline">\(\alpha\)</span> de rechazarla. En simulación tiene mucho más sentido realizar un gran número de pruebas:</p>
<ul>
<li><p>La proporción de rechazos debería aproximarse al valor de <span class="math inline">\(\alpha\)</span>(se puede comprobar para distintos valores de <span class="math inline">\(\alpha\)</span>).</p></li>
<li><p>La distribución del estadístico debería ajustarse a la teórica bajo <span class="math inline">\(H_{0}\)</span>(se podría realizar un nuevo contraste de bondad de ajuste).</p></li>
<li><p>Los <em>p</em>-valores obtenidos deberían ajustarse a una <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (se podría realizar también un contraste de bondad de ajuste).</p></li>
</ul>
<p>Este procedimiento es también el habitual para validar un método de contraste de hipótesis por simulación.</p>

<div class="example">
<span id="exm:unnamed-chunk-18" class="example"><strong>Ejemplo 2.1  </strong></span>
</div>

<p>Consideramos el generador congruencial RANDU:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores iniciales</span>
<span class="kw">initRANDC</span>(<span class="dv">543210</span>)   <span class="co"># Fijar semilla para reproductibilidad</span>
<span class="co"># set.seed(543210)</span>
n &lt;-<span class="st"> </span><span class="dv">500</span>
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)

<span class="co"># Realizar contrastes</span>
<span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {
  u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(n)    <span class="co"># Generar</span>
  <span class="co"># u &lt;- runif(n)</span>
  tmp &lt;-<span class="st"> </span><span class="kw">chisq.test.cont</span>(u, <span class="dt">distribution=</span><span class="st">&quot;unif&quot;</span>, 
                        <span class="dt">nclasses=</span><span class="dv">100</span>, <span class="dt">output=</span><span class="ot">FALSE</span>, <span class="dt">nestpar=</span><span class="dv">0</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
  estadistico[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;\nProporción de rechazos al 1% =&quot;, sum(pvalor &lt; 0.01)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;Proporción de rechazos al 5% =&quot;, sum(pvalor &lt; 0.05)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Proporción de rechazos al 5% = 0.051</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;Proporción de rechazos al 10% =&quot;, sum(pvalor &lt; 0.1)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Proporción de rechazos al 10% = 0.112</code></pre>
<p>Análisis del estadístico contraste:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma</span>
<span class="kw">hist</span>(estadistico, <span class="dt">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">curve</span>(<span class="kw">dchisq</span>(x,<span class="dv">99</span>), <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test ji-cuadrado</span>
<span class="co"># chisq.test.cont(estadistico, distribution=&quot;chisq&quot;, nclasses=20, nestpar=0, df=99)</span>
<span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(estadistico, <span class="st">&quot;pchisq&quot;</span>, <span class="dt">df=</span><span class="dv">99</span>)</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  estadistico
## D = 0.023499, p-value = 0.6388
## alternative hypothesis: two-sided</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma</span>
<span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>) <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test ji-cuadrado</span>
<span class="co"># chisq.test.cont(pvalor, distribution=&quot;unif&quot;, nclasses=20, nestpar=0, min=0, max=1)</span>
<span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(pvalor, <span class="st">&quot;punif&quot;</span>,  <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  pvalor
## D = 0.023499, p-value = 0.6388
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="baterias-de-contrastes" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Baterías de contrastes</h3>
<p>Contrastes específicos para generadores aleatorios:</p>
<ul>
<li><p>Diehard tests (The Marsaglia Random Number CDROM): <a href="http://www.stat.fsu.edu/pub/diehard" class="uri">http://www.stat.fsu.edu/pub/diehard</a>.</p></li>
<li><p>TestU01: <a href="http://www.iro.umontreal.ca/simardr/testu01/tu01.html" class="uri">http://www.iro.umontreal.ca/simardr/testu01/tu01.html</a>.</p></li>
<li><p>NIST test suite: <a href="http://csrc.nist.gov/groups/ST/toolkit/rng" class="uri">http://csrc.nist.gov/groups/ST/toolkit/rng</a>.</p></li>
<li><p>Dieharder (paquete <code>RDieHarder</code>): <a href="http://www.phy.duke.edu/rgb/General/dieharder.php" class="uri">http://www.phy.duke.edu/rgb/General/dieharder.php</a></p></li>
<li><p>Entidad Certificadora (gratuita): <a href="http://www.cacert.at/random">CAcert</a>.</p></li>
</ul>
<p>Documentación adicional:</p>
<ul>
<li><p>Randomness Tests: A Literature Survey <a href="http://www.ciphersbyritter.com/RES/RANDTEST.HTM" class="uri">http://www.ciphersbyritter.com/RES/RANDTEST.HTM</a>-</p></li>
<li><p>Marsaglia, Tsang (2002). Some Difficult-to-pass Tests of Randomness: <a href="http://www.jstatsoft.org/v07/i03" class="uri">http://www.jstatsoft.org/v07/i03</a><br />
<a href="http://www.csis.hku.hk/cisc/download/idetect" class="uri">http://www.csis.hku.hk/cisc/download/idetect</a></p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cap3-gen-cong.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ejercicios-de-fin-de-practica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/03-Generacion_numeros_aleatorios.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
